(* ::Package:: *)

(* ::Input:: *)
(*BeginPackage["Spline`"];*)


(* ::Input:: *)
(*Clear["Spline`*"];*)


(* ::Input:: *)
(*H1::usage="";*)
(*H2::usage="";*)
(*H3::usage="";*)
(*H4::usage="";*)
(*H1n::usage="";*)
(*H2n::usage="";*)
(*H3n::usage="";*)
(*H4n::usage="";*)
(*arc1::usage="";*)
(*arc2::usage="";*)
(*arc3::usage="";*)
(*arc4::usage="";*)
(*BC::usage="";*)
(*Pascal::usage="";*)
(*BS::usage="";*)
(*BS2gen::usage="";*)
(*BS3gen::usage="";*)
(*BS3gen2::usage="";*)
(*BS4gen::usage="";*)
(*BS4gen2::usage="";*)
(*BS4gen3::usage="";*)


(* ::Input:: *)
(*Begin["Spline`Private`"];*)


(* ::Input:: *)
(*H1[Coef_,M_,s_,e_]:= Module[{*)
(*MID={{1,1/2}},*)
(*H={{s[[1]],s[[2]]},{e[[1]],e[[2]]}}*)
(*},*)
(*{{s[[1]],s[[2]]},{e[[1]],e[[2]]}}*)
(*]*)
(*H2[Coef_,M_,s_,c1_,e_]:= Module[{*)
(*MID={{1,1/2,(1/2)^2}},*)
(*H={{s[[1]],s[[2]],0},{x,y,0},{e[[1]],e[[2]],0}},dest={{c1[[1]],c1[[2]],0}}*)
(*},*)
(*result = Solve[MID.Coef.M.H==dest,{x,y}];*)
(*{{s[[1]],s[[2]],0},{result[[1]][[1]][[2]],result[[1]][[2]][[2]],0},{e[[1]],e[[2]],0}}*)
(*]*)
(*H3[Coef_,M_,s_,c1_,c2_,e_]:= Module[{*)
(*LEFT={{1,1/3,(1/3)^2,(1/3)^3}},*)
(*RIGHT={{1,2/3,(2/3)^2,(2/3)^3}},*)
(*H={{s[[1]],s[[2]],0,0},{w,x,0,0},{y,z,0,0},{e[[1]],e[[2]],0,0}},*)
(*destL={{c1[[1]],c1[[2]],0,0}},*)
(*destR={{c2[[1]],c2[[2]],0,0}}*)
(*},*)
(*polyL=LEFT.Coef.M.H==destL;*)
(*polyR=RIGHT.Coef.M.H==destR;*)
(*result=Solve[polyL&&polyR,{w,x,y,z}];*)
(*{{s[[1]],s[[2]],0,0},{result[[1]][[1]][[2]],result[[1]][[2]][[2]],0,0},{result[[1]][[3]][[2]],result[[1]][[4]][[2]],0,0},{e[[1]],e[[2]],0,0}}*)
(*]*)
(*H4[Coef_,M_,s_,c1_,c2_,c3_,e_]:= Module[{*)
(*LEFT={{1,1/4,(1/4)^2,(1/4)^3,(1/4)^4}},*)
(*MID={{1,2/4,(2/4)^2,(2/4)^3,(2/4)^4}},*)
(*RIGHT={{1,3/4,(3/4)^2,(3/4)^3,(3/4)^4}},*)
(*H={{s[[1]],s[[2]],0,0,0},{u,v,0,0,0},{w,x,0,0,0},{y,z,0,0,0},{e[[1]],e[[2]],0,0,0}},*)
(*destL={{c1[[1]],c1[[2]],0,0,0}},*)
(*destM={{c2[[1]],c2[[2]],0,0,0}},*)
(*destR={{c3[[1]],c3[[2]],0,0,0}}*)
(*},*)
(*polyL=LEFT.Coef.M.H==destL;*)
(*polyM=MID.Coef.M.H==destM;*)
(*polyR=RIGHT.Coef.M.H==destR;*)
(*result=Solve[polyL&&polyM&&polyR,{u,v,w,x,y,z}];*)
(*{{s[[1]],s[[2]],0,0,0},{result[[1]][[1]][[2]],result[[1]][[2]][[2]],0,0,0},{result[[1]][[3]][[2]],result[[1]][[4]][[2]],0,0,0},{result[[1]][[5]][[2]],result[[1]][[6]][[2]],0,0,0},{e[[1]],e[[2]],0,0,0}}*)
(*]*)
(*H1n[M_,s_,e_]:= Module[{*)
(*MID={{1,1/2}},*)
(*H={{s[[1]],s[[2]]},{e[[1]],e[[2]]}}*)
(*},*)
(*{{s[[1]],s[[2]]},{e[[1]],e[[2]]}}*)
(*]*)
(*H2n[M_,s_,c1_,e_]:= Module[{*)
(*MID={{1,1/2,(1/2)^2}},*)
(*H={{s[[1]],s[[2]],0},{x,y,0},{e[[1]],e[[2]],0}},dest={{c1[[1]],c1[[2]],0}}*)
(*},*)
(*result = Solve[MID.M.H==dest,{x,y}];*)
(*{{s[[1]],s[[2]],0},{result[[1]][[1]][[2]],result[[1]][[2]][[2]],0},{e[[1]],e[[2]],0}}*)
(*]*)
(*H3n[M_,s_,c1_,c2_,e_]:= Module[{*)
(*LEFT={{1,1/3,(1/3)^2,(1/3)^3}},*)
(*RIGHT={{1,2/3,(2/3)^2,(2/3)^3}},*)
(*H={{s[[1]],s[[2]],0,0},{w,x,0,0},{y,z,0,0},{e[[1]],e[[2]],0,0}},*)
(*destL={{c1[[1]],c1[[2]],0,0}},*)
(*destR={{c2[[1]],c2[[2]],0,0}}*)
(*},*)
(*polyL=LEFT.M.H==destL;*)
(*polyR=RIGHT.M.H==destR;*)
(*result=Solve[polyL&&polyR,{w,x,y,z}];*)
(*{{s[[1]],s[[2]],0,0},{result[[1]][[1]][[2]],result[[1]][[2]][[2]],0,0},{result[[1]][[3]][[2]],result[[1]][[4]][[2]],0,0},{e[[1]],e[[2]],0,0}}*)
(*]*)
(*H4n[M_,s_,c1_,c2_,c3_,e_]:= Module[{*)
(*LEFT={{1,1/4,(1/4)^2,(1/4)^3,(1/4)^4}},*)
(*MID={{1,2/4,(2/4)^2,(2/4)^3,(2/4)^4}},*)
(*RIGHT={{1,3/4,(3/4)^2,(3/4)^3,(3/4)^4}},*)
(*H={{s[[1]],s[[2]],0,0,0},{u,v,0,0,0},{w,x,0,0,0},{y,z,0,0,0},{e[[1]],e[[2]],0,0,0}},*)
(*destL={{c1[[1]],c1[[2]],0,0,0}},*)
(*destM={{c2[[1]],c2[[2]],0,0,0}},*)
(*destR={{c3[[1]],c3[[2]],0,0,0}}*)
(*},*)
(*polyL=LEFT.M.H==destL;*)
(*polyM=MID.M.H==destM;*)
(*polyR=RIGHT.M.H==destR;*)
(*result=Solve[polyL&&polyM&&polyR,{u,v,w,x,y,z}];*)
(*{{s[[1]],s[[2]],0,0,0},{result[[1]][[1]][[2]],result[[1]][[2]][[2]],0,0,0},{result[[1]][[3]][[2]],result[[1]][[4]][[2]],0,0,0},{result[[1]][[5]][[2]],result[[1]][[6]][[2]],0,0,0},{e[[1]],e[[2]],0,0,0}}*)
(*]*)
(*arc1[Coef_,M_,s_,e_]:=Module[{},*)
(*sol = H1[Coef,M,s,e]; Table[{p=Flatten[{{1,t}}.Coef.M.sol];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/2}]*)
(*]*)
(*arc2[Coef_,M_,s_,c1_,e_]:=Module[{},*)
(*sol = H2[Coef,M,s,c1,e]; Table[{p=Flatten[{{1,t,t^2}}.Coef.M.sol];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/4}]*)
(*]*)
(*arc3[Coef_,M_,s_,c1_,c2_,e_]:=Module[{},*)
(*sol = H3[Coef,M,s,c1,c2,e]; Table[{p=Flatten[{{1,t,t^2,t^3}}.Coef.M.sol];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/6}]*)
(*]*)
(*arc4[Coef_,M_,s_,c1_,c2_,c3_,e_]:=Module[{},*)
(*sol = H4[Coef,M,s,c1,c2,c3,e]; Table[{p=Flatten[{{1,t,t^2,t^3,t^4}}.Coef.M.sol];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/8}]*)
(*]*)
(*BC[n_,i_]:=Module[{},Factorial[n]/((Factorial[i])*Factorial[n-i])]*)
(*Pascal[n_]=Module[{},Table[{((-1)^i)*BC[n,i]},{i,0,n}]]*)
(*BS[n_,i_,t_]:=Module[{},BC[n,i]*(t^i)*(1-t)^(n-i)]*)
(*BS2gen[xin_,i_]:=Module[{*)
(*Coef2,*)
(*H2*)
(*},*)
(*Clear[y];Clear[x];*)
(*Coef2 = {{1,0,0},{-1,1,0},{0,-1,1}};*)
(*H2={{0,0,0},{x,y,0},{1,0,0}};*)
(*eq=Det[Coef2.H2-t*IdentityMatrix[3]]==BS[3,i,t];*)
(*sol=Solve[eq,{y}][[1]][[1]][[2]];*)
(*Table[{p=Flatten[x=xin;y=sol;{{1,t,t^2}}.Coef2.H2];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/4}]]*)
(*BS3gen[win_,yin_,zin_,i_]:=Module[{*)
(*Coef3,*)
(*H3*)
(*},*)
(*Clear[w,x,y,z];*)
(*Coef3 = {{1,0,0,0},{-1,1,0,0},{0,-1,1,0},{0,0,-1,1}};*)
(*H3={{0,0,0,0},{w,x,0,0},{y,z,0,0},{1,0,0,0}};*)
(*eq=Det[Coef3.H3-t*IdentityMatrix[4]]==BS[4,i,t];*)
(*sol=Solve[eq,{x}][[1]][[1]][[2]];*)
(*Table[{p=Flatten[w=win;x=sol;y=yin;z=zin;{{1,t,t^2,t^3}}.Coef3.H3];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/6}]]*)
(*BS3gen2[win_,yin_,i_]:=Module[{*)
(*Coef3,*)
(*Coef2,*)
(*H3,*)
(*H2*)
(*},*)
(*Clear[w,x,y,z];*)
(*Coef3 = {{1,0,0,0},{-1,1,0,0},{0,-1,1,0},{0,0,-1,1}};*)
(*H3={{0,0,0,0},{w,x,0,0},{y,z,0,0},{1,0,0,0}};*)
(*eq=Det[Coef3.H3-t*IdentityMatrix[4]]==BS[4,i,t];*)
(*sol=Solve[eq,{x}][[1]][[1]][[2]];*)
(*Coef2 = {{-1,0,0},{0,-1,0},{0,0,-1}};*)
(*H2={{w,0,0},{y,z,0},{1,0,0}};*)
(*eq2=Det[Coef2.H2 -t*IdentityMatrix[3]]==BS[3,i-1,t];*)
(*Clear[w,y,z];*)
(*sol2=Solve[eq2,{z}][[1]][[1]][[2]];*)
(*points=Table[{p=Flatten[w=win;x=sol;y=yin;z=sol2;{{1,t,t^2,t^3}}.Coef3.H3];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/6}]]*)
(*BS4gen2[uin_,win_,yin_,zin_,i_]:=Module[{*)
(*Coef4,*)
(*Coef3,*)
(*H4,*)
(*H3*)
(*},*)
(*Clear[u,v,w,x,y,z];*)
(*Coef4={{1,0,0,0,0},{-1,1,0,0,0},{0,-1,1,0,0},{0,0,-1,1,0},{0,0,0,-1,1}};*)
(*H4={{0,0,0,0,0},{u,v,0,0,0},{w,x,0,0,0},{y,z,0,0,0},{1,0,0,0,0}};*)
(*eq=Det[Coef4.H4-t*IdentityMatrix[5]]==BS[5,i,t];*)
(*sol=Solve[eq,{v}][[1]][[1]][[2]];*)
(*Coef3={{-1,0,0,0},{0,-1,0,0},{0,0,-1,0},{0,0,0,-1}};*)
(*H3={{u,0,0,0},{w,x,0,0},{y,z,0,0},{1,0,0,0}};*)
(*eq2=Det[Coef3.H3-t*IdentityMatrix[4]]==BS[4,i-1,t];*)
(*Clear[u,w,x,y,z];*)
(*sol2=Solve[eq2,{x}][[1]][[1]][[2]];*)
(*Table[{p=Flatten[u=uin;v=sol;w=win;x=sol2;y=yin;z=zin;{{1,t,t^2,t^3,t^4}}.Coef4.H4];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/8}]]*)
(*BS4gen3[uin_,win_,yin_,i_]:=Module[{*)
(*Coef4,*)
(*Coef3,*)
(*Coef2,*)
(*H4,*)
(*H3,*)
(*H2*)
(*},*)
(*Clear[u,v,w,x,y,z];*)
(*Coef4={{1,0,0,0,0},{-1,1,0,0,0},{0,-1,1,0,0},{0,0,-1,1,0},{0,0,0,-1,1}};*)
(*H4={{0,0,0,0,0},{u,v,0,0,0},{w,x,0,0,0},{y,z,0,0,0},{1,0,0,0,0}};*)
(*eq=Det[Coef4.H4-t*IdentityMatrix[5]]==BS[5,i,t];*)
(*sol=Solve[eq,{v}][[1]][[1]][[2]];*)
(*Coef3={{-1,0,0,0},{0,-1,0,0},{0,0,-1,0},{0,0,0,-1}};*)
(*H3={{u,0,0,0},{w,x,0,0},{y,z,0,0},{1,0,0,0}};*)
(*eq2=Det[Coef3.H3-t*IdentityMatrix[4]]==BS[4,i-1,t];*)
(*Clear[u,w,x,y,z];*)
(*sol2=Solve[eq2,{x}][[1]][[1]][[2]];*)
(*Coef2={{1,0,0},{0,1,0},{0,0,1}};*)
(*H2={{w,0,0},{y,z,0},{1,0,0}};*)
(*eq3=Det[Coef2.H2-t*IdentityMatrix[3]]==BS[3,i-2,t];*)
(*sol3=Solve[eq3,{z}][[1]][[1]][[2]];*)
(*Table[{p=Flatten[u=uin;v=sol;w=win;x=sol2;y=yin;z=sol3;{{1,t,t^2,t^3,t^4}}.Coef4.H4];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/8}]]*)
(*BS4gen[uin_,win_,xin_,yin_,zin_,i_]:=Module[{*)
(*Coef4,*)
(*H4*)
(*},*)
(*Clear[u,v,w,x,y,z];*)
(*Coef4={{1,0,0,0,0},{-1,1,0,0,0},{0,-1,1,0,0},{0,0,-1,1,0},{0,0,0,-1,1}};*)
(*H4={{0,0,0,0,0},{u,v,0,0,0},{w,x,0,0,0},{y,z,0,0,0},{1,0,0,0,0}};*)
(*eq=Det[Coef4.H4-t*IdentityMatrix[5]]==BS[5,i,t];*)
(*sol=Solve[eq,{v}][[1]][[1]][[2]];*)
(*Table[{p=Flatten[u=uin;v=sol;w=win;x=xin;y=yin;z=zin;{{1,t,t^2,t^3,t^4}}.Coef4.H4];*)
(*p[[1]],*)
(*p[[2]]*)
(*},{t,0,1,1/8}]]*)


(* ::Input:: *)
(*End[];*)
(*EndPackage[];*)
